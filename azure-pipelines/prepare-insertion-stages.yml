parameters:
- name: RealSign
  type: boolean
  default: false

stages:

- stage: release
  displayName: Publish
  condition: and(succeeded(), eq('${{ parameters.RealSign }}', 'true'))
  jobs:
  - ${{ if true }}: # leave the condition to avoid merge conflicts later.
    - job: push
      displayName: azure-public/winsdk feed
      pool:
        vmImage: ubuntu-20.04
      templateContext:
        outputs:
        - output: nuget
          displayName: ğŸ“¦ Push nuget packages
          packagesToPush: '$(Pipeline.Workspace)/deployables-Windows/NuGet/*.nupkg'
          packageParentPath: $(Pipeline.Workspace)/deployables-Windows/NuGet
          allowPackageConflicts: true
          nuGetFeedType: external
          publishFeedCredentials: azure-public/winsdk
      steps:
      - checkout: none
      - download: current
        artifact: Variables-Windows
        displayName: ğŸ”» Download Variables-Windows artifact
      - powershell: $(Pipeline.Workspace)/Variables-Windows/_pipelines.ps1
        displayName: âš™ï¸ Set pipeline variables based on artifacts
      - download: current
        artifact: deployables-Windows
        displayName: ğŸ”» Download deployables-Windows artifact
